@page
@model web_mybottyTV.Pages.IndexModel
@{
    Layout = "_Layout"; 
}

@if (!User.Identity?.IsAuthenticated ?? true)
{
    <a href="/auth/login">Войти через Twitch</a>
}
else
{
    <span>@User.Identity?.Name</span>
    <a href="/auth/logout">Выйти</a>
}

@if (!User.Identity?.IsAuthenticated == true)
{
    <div class="alert alert-warning">
        Не удалось определить ваш канал. Пожалуйста, войдите через Twitch.
    </div>
}
else
{
    <div class="channel-management">
        <h1>Управление каналом <span class="channel-name">@Model.Channel.ChannelName</span></h1>

        <table class="commands-table">
            <thead>
                <tr>
                    <th>Команда</th>
                    <th>Действие</th>
                    <th>Ответ</th>
                    <th>Вкл.</th>
                    <th>Редактировать</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var cmd in Model.Channel.Settings)
                {
                    <tr>
                        <td>@cmd.CommandName</td>
                        <td>@cmd.ActionType</td>
                        <td>@cmd.Response</td>
                        <td>
                            <input type="checkbox" disabled @(cmd.IsEnabled ? "checked" : "") />
                        </td>
                        <td>
                            <a class="edit-link" asp-page="/EditCommand" asp-route-command="@cmd.CommandName">
                                Редактировать
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <a class="add-command-link" asp-page="/AddCommand">➕ Добавить новую команду</a>
    </div>
}
